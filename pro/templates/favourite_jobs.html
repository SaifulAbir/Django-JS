{% extends 'professional_layout.html' %}
{% load static %}
{% block professional_breadcrumb %}

   <!-- Breadcrumb -->
    <div class="alice-bg padding-top-70 padding-bottom-70">
      <div class="container">
        <div class="row">
          <div class="col-md-6">
            <div class="breadcrumb-area">
              <h1>Favourite Jobs</h1>
              <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="#">Home</a></li>
                  <li class="breadcrumb-item active" aria-current="page">Favourite Jobs</li>
                </ol>
              </nav>
            </div>
          </div>
          <div class="col-md-6">
            <div class="breadcrumb-form">
              <form action="#">
                <input type="text" placeholder="Enter Keywords">
                <button><i data-feather="search"></i></button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Breadcrumb End -->
    {% endblock %}

{% block professional_block %}
                <div class="dashboard-bookmarked">
                  <h4 class="bookmark-title"></h4>
                  <div class="bookmark-area">






                  </div>
                </div>

{% endblock %}
{% block extra_js %}
    <script>
       $(document).ready(function() {
           $('.favourite-job-bar').addClass('active')
        var path = window.location.pathname.split('/')
        var id = path[path.length-2]
        var getUrl = '/api/job/favourite/';
        get(getUrl, favJobs);
        TokenAuthenticate();


    });
       //appending fav jobs to html
       function  favJobs(data){
           console.log(data)
            number_of_jobs_bookmarked=data.length;
            $('.bookmark-title').append(number_of_jobs_bookmarked," Job Bookmarked");
            for(index=0;index<6;index++){
            var dateString = data[index].application_deadline;
            var momentObj = moment(dateString, 'YYYY-MM-DD');
            var dateMomentString = momentObj.format('MMM DD, YYYY');
            if (dateMomentString=='Invalid date'){
             var dateMomentString = "n/a";
            }
            var fav_jobs_html = '<div class="job-list" >'+
                      '<div class="thumb">'+
                        '<a href="#">'+
                          '<img src="'+data[index].profile_picture+'" style="max-width:70px"; class="img-fluid" alt="">'+
                        '</a>'+
                      '</div>'+
                      '<div class="body">'+
                        '<div class="content">'+
                          '<h4><a href="/job-detail/'+ data[index].slug+'">'+data[index].title+'</a></h4>'+
                          '<div class="info">'+
                            '<span class="company"><a href="#"><i class="fas fa-building" style="margin-right: 5px"></i>'+data[index].company_name+'</a></span>'+
                            '<span class="office-location"><a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-map-pin"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>'+data[index].job_location+'</a></span>'+
                            '<span class="job-type full-time"><a href="#"><img style="margin-right: 6px; vertical-align: top; padding-top: 5px;" src="/static/images/img_clock.png" width="12">'+data[index].employment_status+'</a></span>'+
                          '</div>'+
                        '</div>'+
                        '<div class="more">'+
                          '<div class="buttons">'+
                            '<a href="#" class="button">Apply Now</a>'+
                            '<a href="#" class="favourite"><i data-feather="heart"></i></a>'+
                          '</div>'+
                          '<a href="'+data[index].job_id+'"  class="bookmark-remove" ><i class="fas fa-times"></i></a>'+
                          '<p class="deadline">Deadline:'+dateMomentString+'</p>'+
                        '</div>'+
                      '</div>'+
                   '</div>';
                 $('.bookmark-area').append(fav_jobs_html);

        }

}
//on click function for removing and sending id for each job in api
       $('.bookmark-area').on('click','.bookmark-remove',function (event) {
           event.preventDefault()
           $(this).parent().parent().parent().remove();
           favouriteJobAddRemove('job-list', '/api/job/favourite/toggle')

       });

{% comment %}function myFunction(event,elm,clicked_id) {
           event.preventDefault()
 $(elm )
 identifier = elm.id;
 catUrl ='job/favourite/toggle';
 get(catUrl,reWriter);
    favouriteJobAddRemove('job-list', '/api/job/favourite/toggle');
}

//function for rewriting for showing up to date total bookmarked jobs
function reWriter(data){
showSuccess("Job Removed!", "")
number_of_jobs_bookmarked=data.total_bookmarked;
document.getElementsByClassName("bookmark-title")[0].innerHTML = number_of_jobs_bookmarked + " Job Bookmarked";
}{% endcomment %}


    </script>
{% endblock %}