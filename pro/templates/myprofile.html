{% extends 'professional_layout.html' %}
{% load static %}



<!-- Breadcrumb -->
{% block professional_breadcrumb %}
    <div class="alice-bg padding-top-70 padding-bottom-70">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <div class="breadcrumb-area">
                        <h1>View Profile</h1>
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="/">Home</a></li>
                                <li class="breadcrumb-item active" aria-current="page">View Profile</li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Breadcrumb End -->
{% endblock %}


{% block professional_block %}
{#    <div class="download-resume dashboard-section">#}
{#        <a href="#">Download CV<i data-feather="download"></i></a>#}
{#        <a href="#">Download Cover Letter<i data-feather="download"></i></a>#}
{#    </div>#}
    <div class="skill-and-profile dashboard-section float-right">
{#        <div class="skill">#}
{#            <label>Skills:</label>#}
{#        </div>#}
        <div class="social-profile ">
            <label>Social:</label>

            <a href="#" id="facebook"><i class="fab fa-facebook-f" ></i></a>
            <a href="#" id="twitter"><i class="fab fa-twitter" ></i></a>
            <a href="#" id="linkedin"><i class="fab fa-linkedin-in" ></i></a>

        </div>
    </div>
    <div class="col-sm-6">
        <div class="dashboard-section upload-profile-photo">
            <div class="update-photo">
                <!--                <input type="text" id="image" value="">-->
                <img id="image1" class="image" src="{% static 'dashboard/images/user-1.jpg' %}" alt="">
            </div>
        </div>
    </div>
    <div class="about-details details-section dashboard-section">
        <h4><i data-feather="user-check"></i>Basic Info</h4>
        <div class="pro_about" id="about-details-div">
        <div class="information-and-contact">
            <ul>
                        <div id="basic-info-margin">
                            <span><h8>About Me: </h8></span><br>
                            <span class="about" id="about_me"></span>
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <span><h8>Industry: </h8></span> <span id="industry_expertise"></span>
                            </div>
                            <div class="col-sm-6">
                                <span><h8>Location: </h8></span> <span id="address"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <span><h8>Status:</h8></span> <span id="status"></span>
                            </div>
                            <div class="col-sm-6">
                                <span><h8>Experience:</h8></span> <span id="experience"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-6">
                                <span><h8>Salary:</h8></span> <span class="about-info-salary" id="expected_salary_min"></span><span class="about-info-salary" id="expected_salary_max"></span>
                            </div>
                            <div class="col-sm-6">
                                <span><h8>Qualification:</h8></span> <span id="qualification"></span>
                            </div>
                        </div>
                        <!--                    <li><span>Age:</span> <span id="status"></span></li>-->
                    </ul>
        </div>
    </div>
    </div>
    <div class="edication-background details-section dashboard-section" id="edu">
        <h4><i data-feather="book"></i>Education</h4>
    </div>
    <div class="experience dashboard-section details-section" id="work">
        <h4><i data-feather="briefcase"></i>Work Experience</h4>
    </div>

    <div class="professonal-skill dashboard-section details-section">
        <h4><i data-feather="feather"></i>Professional Skill</h4>

        <div class="progress-group" id="pro_skill">
        </div>
    </div>

    <div class="certification dashboard-section details-section" id="work">
        <h4><i data-feather="gift"></i>Certification</h4>
    </div>

    <div class="membership dashboard-section details-section" id="work">
        <h4><i data-feather="user-check"></i>Membership</h4>
    </div>

    <div class="portfolio dashboard-section details-section" id="pro_portfolio">
        <h4><i data-feather="gift"></i>Portfolio</h4>
    </div>


    <div class="personal-information dashboard-section last-child details-section" id="details">
        <h4><i data-feather="user-plus"></i>Personal Deatils</h4>
    </div>
{% endblock %}

{% block extra_js %}
    <script>
        $(document).ready(function() {
            $('.profile-details-bar').addClass('active')
            initAjaxSelects();
            $('#profile-form').validate();
            var path = window.location.pathname.split('/');
            var id = path[path.length-2];

            var getUrl = '/api/professional/profile/'+ id + '/';
            get(getUrl, loadProfile);

            initAjaxForms();

        });

        function loadProfile(data){




            //profile picture shows

            // $('#pro_pic').append('<img src="'+data.personal_info.image+'" class="img-fluid" alt="">');

            $('#image1').attr('src', data.personal_info.image);

            //            console.log(data.personal_info.image)
            //        $('#pro_pic').append('<img src="{% static 'images/icon-114x114.png'%}" class="img-fluid" alt="">');





            //social link shows
            console.log(data.personal_info)
            if (!data.personal_info.facebook_id){
                data.personal_info.facebook_id= "";
            }
            if (!data.personal_info.facebook_id){
                data.personal_info.twitter_id= "";
            }
            if (!data.personal_info.facebook_id){
                data.personal_info.linkedin_id= "";
            }
            facebook = 'http://facebook.com/'+data.personal_info.facebook_id;
            twitter  = 'http://twitter.com/'+data.personal_info.twitter_id;
            linkedin = 'http://linkedin.com/'+data.personal_info.linkedin_id;
            $('#facebook').attr('href',facebook);
            $('#twitter').attr('href',twitter);
            $('#linkedin').attr('href', linkedin);



            //about info show

            function getAge(dateString)
            {
                var today = new Date();
                var birthDate = new Date(dateString);
                var age = today.getFullYear() - birthDate.getFullYear();
                var m = today.getMonth() - birthDate.getMonth();
                if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate()))
                {
                    age--;
                }
                return age;
            }
            var pro_age = getAge(data.personal_info.date_of_birth)
            {#var about_html='<p>'+data.personal_info.about_me+'</p>';#}
            {#$(".pro_about").html(about_html);#}
            if (!data.personal_info.industry_expertise){
                data.personal_info.industry_expertise= "";
            }
            if (!data.personal_info.address){
                data.personal_info.address= "";
            }
            if (!data.personal_info.status){
                data.personal_info.status= "";
            }
            if (!data.personal_info.experience){
                data.personal_info.experience= "";
            }if (!data.personal_info.status){
                data.personal_info.status= "";
            }if (data.personal_info.expected_salary_min && data.personal_info.expected_salary_max){
                data.personal_info.expected_salary_min = 'BDT '+Number(data.personal_info.expected_salary_min).toLocaleString('en')+' - ';
                data.personal_info.expected_salary_max = Number(data.personal_info.expected_salary_max).toLocaleString('en');
            }

            else{
                data.personal_info.expected_salary_min = "";
                data.personal_info.expected_salary_max = "";
            }

            if (!data.personal_info.gender){
                data.personal_info.gender= "";
            }
            if (!pro_age){
                pro_age= "";
            }
            if (!data.personal_info.qualification){
                data.personal_info.qualification= "";
            }
            about_container = $('.pro_about');
            json2DivPopulate(data.personal_info, about_container);
            {#var info_html =#}
            {#    '<ul>'+#}
            {#    '<li><span>Category:</span> '+data.personal_info.industry_expertise+'</li>'+#}
            {#    '<li><span>Location:</span> '+data.personal_info.address+'</li>'+#}
            {#    '<li><span>Status:</span>'+data.personal_info.status+'</li>'+#}
            {#    '<li><span>Experience:</span>'+data.personal_info.experience+'</li>'+#}
            {#    '<li><span>Salary:</span> '+data.personal_info.expected_salary_min+'  '+data.personal_info.expected_salary_max+'</li>'+#}
            {#    '<li><span>Gender:</span>'+data.personal_info.gender+'</li>'+#}
            {#    '<li><span>Age:</span>'+pro_age+' Year(s)</li>'+#}
            {#    '<li><span>Qualification:</span>'+data.personal_info.qualification+'</li>'+#}
            {#    '</ul>';#}
            {#$(".information-and-contact").html(info_html);#}


            //education info show

            edu_data = data['edu_info']
            len = edu_data.length;
            for(x=0;x<len;x++){
                var enrolled_date = edu_data[x].enrolled_date;
                var momentObj = moment(enrolled_date, 'YYYY-MM-DD');
                var enrolled_date = momentObj.format('DD-MM-YYYY') + ' - ';
                if(edu_data[x].is_ongoing == true){
                    var graduation_date = 'Present';
                }
                else if(edu_data[x].graduation_date){

                    var graduation_date = edu_data[x].graduation_date;
                    var momentObj = moment(graduation_date, 'YYYY-MM-DD');
                    var graduation_date = momentObj.format('DD-MM-YYYY');
                }
                else{
                    var graduation_date = '';
                }
                if (!edu_data[x].institution_text){
                    edu_data[x].institution_text="";
                }

                if(edu_data[x].major_obj.name && edu_data[x].cgpa){
                    edu_data[x].major_obj.name = edu_data[x].major_obj.name+'</b> -';
                    edu_data[x].cgpa = edu_data[x].cgpa;
                }
                else{
                    edu_data[x].major_obj.name = "";
                    edu_data[x].cgpa = "";
                }
                if (!edu_data[x].major_text){
                    edu_data[x].major_text="";
                }
                if(!edu_data[x].description){
                    edu_data[x].description = ''
                }
                var edu_html='<div class="education-label">'+
                    '<span class="study-year">'+enrolled_date+'  '+graduation_date+'</span>'+
                    '<h5>'+edu_data[x].degree+'<span>@'+edu_data[x].institution_text+'</span></h5>'+
                    '<p>'+edu_data[x].description+'</p>'+
                    '</div><br>';
                $('#edu').append(edu_html);
            }


            //work experience info show

            experience_info = data.experience_info
            console.log(data.experience_info)
            len = experience_info.length;
            for(x=0;x<len;x++){
                if(experience_info[x].start_date){
                             var start_date = experience_info[x].start_date;
                             var momentObj = moment(start_date, 'YYYY-MM-DD');
                             var start_date = momentObj.format('DD-MM-YYYY');
                    }
                    else{
                         start_date = '';
                    }
                    if(experience_info[x].end_date){

                             var end_date = experience_info[x].end_date;
                             var momentObj = moment(end_date, 'YYYY-MM-DD');
                             var end_date = momentObj.format('DD-MM-YYYY');
                    }
                    else{
                          if(experience_info[x].start_date){
                              var end_date = 'Present';
                          }
                          else{
                           var end_date = '';
                           }
                        }
                    if(experience_info[x].designation){
                            var designation = experience_info[x].designation;
                    }
                    else{
                            var designation =  '';
                    }
                    if(experience_info[x].company){
                         var company = experience_info[x].company;
                    }
                    else{
                         var company = '';
                    }
                    if(experience_info[x].company_text){
                         var company_text =  experience_info[x].company_text;
                    }
                    else{
                         var company_text = '';
                    }
                    if(experience_info[x].description){
                        var description = experience_info[x].description
                    }
                    else{
                        var description = ''
                    }
                var work_html='<div class="experience-section">'+
                    '<span class="service-year">'+start_date+'-'+end_date+'</span>'+
                    '<h5>'+designation+'<span>@'+company_text+'</span></h5>'+
                    '<p>'+ description +'</p></div><br>';
                $('#work').append(work_html);
            }


            //Professional Skill info show

            pro_skill_data = data['skill_info'][0]
            len = pro_skill_data.length;
            for(x=0;x<len;x++){
                var pro_skill_html='<div class="progress-item">'+
                    '<div class="progress-head">'+
                    '<p class="progress-on">'+pro_skill_data[x].skill_obj.name+'</p>'+
                    '</div>'+
                    '<div class="progress-body">'+
                    '<div class="progress">'+
                    '<div class="progress-bar" role="progressbar" aria-valuenow="'+pro_skill_data[x].rating *10+'" aria-valuemin="0" aria-valuemax="100" style="width: 0;"></div>'+
                    '</div>'+
                    '<p class="progress-to">'+pro_skill_data[x].rating+'/10</p>'+
                    '</div>'+
                    '</div>';

                $('#pro_skill').append(pro_skill_html);
            }


            //certification show
            certification_info = data['certification_info']
            len = certification_info.length;
            for(x=0;x<len;x++){

                    if(certification_info[x].issue_date){
                             var issue_date = certification_info[x].issue_date;
                             var momentObj = moment(issue_date, 'YYYY-MM-DD');
                             var issue_date = momentObj.format('DD-MM-YYYY');
                    }
                    else{
                         issue_date = '';
                    }
                    if(certification_info[x].expiry_date){

                             var expiry_date = certification_info[x].expiry_date;
                             var momentObj = moment(expiry_date, 'YYYY-MM-DD');
                             var expiry_date = momentObj.format('DD-MM-YYYY');
                    }
                    else{
                          if(certification_info[x].has_expiry_period == false){
                              var expiry_date = 'Lifetime Certification';
                          }
                          else{
                           var expiry_date = '';
                           }
                        }
                    if(certification_info[x].certificate_name){
                            var certificate_name = certification_info[x].certificate_name;
                    }
                    else{
                            var certificate_name =  '';
                    }
                    if(certification_info[x].credential_id){
                         var credential_id = certification_info[x].credential_id;
                    }
                    else{
                         var credential_id = '';
                    }
                    if(certification_info[x].credential_url){
                         var credential_url = certification_info[x].credential_url;
                    }
                    else{
                         var credential_url = '';
                    }
                    if(certification_info[x].organization){
                         var organization =  certification_info[x].organization;
                    }
                    else{
                         var organization = '';
                    }

                   var cft_html='<div class="certification-label">'+
                    '<span class="study-year">'+issue_date+' - '+expiry_date+'</span>'+
                    '<h5>'+certificate_name+'<span>@ '+organization+'</span></h5>'+
                    '<p><b>'+credential_id+'</b> - <a style="color:blue;" href="'+credential_url+'">view</a></p>'+
                    '</div><br>';
                $('.certification').append(cft_html);
            }

            //membership show
            membership_info = data['membership_info']
            len = membership_info.length;
            for(x=0;x<len;x++){

                    if(membership_info[x].start_date){
                             var start_date = membership_info[x].start_date;
                             var momentObj = moment(start_date, 'YYYY-MM-DD');
                             var start_date = momentObj.format('DD-MM-YYYY');
                    }
                    else{
                         start_date = '';
                    }
                    if(membership_info[x].end_date){

                             var end_date = membership_info[x].end_date;
                             var momentObj = moment(end_date, 'YYYY-MM-DD');
                             var end_date = momentObj.format('DD-MM-YYYY');
                    }
                    else{
                          if(membership_info[x].membership_ongoing == true){
                              var end_date = 'Present';
                          }
                          else{
                           var end_date = '';
                           }
                        }
                    if(membership_info[x].organization){
                            var organization = membership_info[x].organization;
                    }
                    else{
                            var organization =  '';
                    }
                    if(membership_info[x].position_held){
                         var position_held = membership_info[x].position_held;
                    }
                    else{
                         var position_held = '';
                    }
                    if(membership_info[x].description){
                         var description = membership_info[x].description;
                    }
                    else{
                         var description = '';
                    }


            var mbr_html='<div class="membership-label">'+
                '<span class="study-year">'+start_date+' - '+end_date+'</span>'+
                '<h5>'+position_held+'<span> @ ' +organization+'</span></h5>'+
                '<p>'+description+'</p>'+
                '</div><br>';
            $('.membership').append(mbr_html);
            }


            //portfolio show


            portfolio_data = data.portfolio_info
            len = portfolio_data.length;
            for(x=0;x<len;x++) {
                var portfolio_html = '<div class="portfolio-section">\n' +
                '<input type="hidden" class="portfolio-object-id" value="'+portfolio_data[x].id+'">'+
                '                <b class="service-year">'+portfolio_data[x].name+'</b>\n'  +
                '<p>'+ portfolio_data[x].description + '</p>'+
                '              </div>'
                $('.portfolio').append(portfolio_html);
            }




            //personal details show
            if (!data.personal_info.father_name){
                data.personal_info.father_name= "";
            }
            if (!data.personal_info.mother_name){
                data.personal_info.mother_name= "";
            }
            if (!data.personal_info.permanent_address){
                data.personal_info.permanent_address= "";
            }
            var dateofbirth = data.personal_info.date_of_birth
            var momentObj = moment(dateofbirth, 'YYYY-MM-DD');
            var dateMomentString = momentObj.format('DD-MM-YYYY');
            var detail_html = '<ul>'+
                '<li><span>Full Name:</span> '+ data.personal_info.full_name+'</li>'+
                '<li><span>Fathers Name:</span> '+data.personal_info.father_name+'</li>'+
                '<li><span>Mothers Name:</span>'+ data.personal_info.mother_name+'</li>'+
                '<li><span>Date of Birth:</span>'+dateMomentString+'</li>'+
                '<li><span>Nationality:</span> '+data.personal_info.nationality_obj.name+'</li>'+
                '<li><span>Gender:</span>'+data.personal_info.gender+'</li>'+
                '<li><span>Address:</span>'+data.personal_info.permanent_address+'</li>'+
                '</ul>';
            $("#details").append(detail_html);











        }


    </script>
{% endblock %}