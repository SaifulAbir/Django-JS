{% extends 'common_layout.html' %}
{% load static %}
{% block body_block%}
    <!-- Breadcrumb -->
    <div class="alice-bg padding-top-70 padding-bottom-70">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <div class="breadcrumb-area">
                        <h1>Job Listing</h1>
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="#">Home</a></li>
                                <li class="breadcrumb-item active" aria-current="page">Job Listing</li>
                            </ol>
                        </nav>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="breadcrumb-form">
                        <form action="#">
                            <input type="text" placeholder="Enter Keywords">
                            <button><i data-feather="search"></i></button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Breadcrumb End -->



    <!-- Job Listing -->
    <div class="alice-bg section-padding-bottom">
        <div class="container">
            <div class="row no-gutters">
                <div class="col">
                    <div class="job-listing-container">
                        <div class="filtered-job-listing-wrapper">
                            <div class="job-view-controller-wrapper">
                                <div class="job-view-controller">
                                    <div class="controller list active">
                                        <i data-feather="menu"></i>
                                    </div>
                                    <div class="controller grid">
                                        <i data-feather="grid"></i>
                                    </div>
                                    <div class="job-view-filter">
                                        <select class="selectpicker">
                                            <option value="" selected>Most Recent</option>
                                            <option value="california">Top Rated</option>
                                            <option value="las-vegas">Most Popular</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="showing-number">
                                    <span class="pagination-summary display-none"></span>
                                </div>
                            </div>
                            <div class="job-filter-result">
                                <div class="job-result">

                                </div>
                                <div class="apply-popup">
                                    <div class="modal fade" id="apply-popup-id" tabindex="-1" role="dialog" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title"><i data-feather="edit"></i>APPLY FOR THIS JOB</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <form action="#">
                                                        <div class="form-group">
                                                            <input type="text" placeholder="Full Name" class="form-control">
                                                        </div>
                                                        <div class="form-group">
                                                            <input type="email" placeholder="Email Address" class="form-control">
                                                        </div>
                                                        <div class="form-group">
                                                            <textarea class="form-control" placeholder="Message"></textarea>
                                                        </div>
                                                        <div class="form-group file-input-wrap">
                                                            <label for="up-cv">
                                                                <input id="up-cv" type="file">
                                                                <i data-feather="upload-cloud"></i>
                                                                <span>Upload your resume <span>(pdf,zip,doc,docx)</span></span>
                                                            </label>
                                                        </div>
                                                        <div class="more-option">
                                                            <input class="custom-radio" type="checkbox" id="radio-4" name="termsandcondition">
                                                            <label for="radio-4">
                                                                <span class="dot"></span> I accept the <a href="#">terms & conditions</a>
                                                            </label>
                                                        </div>
                                                        <button class="button primary-bg btn-block">Apply Now</button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="pagination-list text-center">
                                {#                                comes from js#}
                            </div>
                        </div>
                        <div class="job-filter-wrapper">
                            <div class="selected-options same-pad">
                                <div class="selection-title">
                                    <h4>You Selected</h4>
                                    <a href="#">Clear All</a>
                                </div>
                                <ul class="filtered-options">
                                </ul>
                            </div>
                            <div class="job-filter-dropdown same-pad category">
                                <select class="selectpicker" data-live-search="true" title="Category" id="category">


                                </select>
                            </div>
                            <div class="job-filter-dropdown same-pad location">
                                <select class="selectpicker" data-live-search="true" title="Location" id="location">


                                </select>
                            </div>
                             <div class="job-filter-dropdown same-pad skill">
                                <select class="selectpicker" data-live-search="true" title="Skill" id="skill">


                                </select>
                            </div>

                            <div data-id="job-type" class="job-filter job-type same-pad">
                                <h4 class="option-title">Job Type</h4>
                                <ul class="typelist">

                                </ul>
                            </div>
                            <div data-id="experience" class="job-filter experience same-pad">
                                <h4 class="option-title">Experience</h4>
                                <ul class="experiencelist">


                                </ul>
                            </div>
                            <div class="job-filter same-pad">
                                <h4 class="option-title">Salary Range</h4>
                                <div class="price-range-slider">
                                    <div class="nstSlider" data-range_min="0" data-range_max="100000"
                                         data-cur_min=""    data-cur_max="">
                                        <div class="bar"></div>
                                        <div class="leftGrip"></div>
                                        <div class="rightGrip"></div>
                                        <div class="grip-label">
                                            <span class="leftLabel"></span>
                                            <span class="rightLabel"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div data-id="post" class="job-filter post same-pad">
                                <h4 class="option-title">Date Posted</h4>
                                <ul>
                                    <li><a href="#" data-attr="Last hour">Last hour</a></li>
                                    <li><a href="#" data-attr="Last 24 hour">Last 24 hour</a></li>
                                    <li><a href="#" data-attr="Last 7 days">Last 7 days</a></li>
                                    <li><a href="#" data-attr="Last 14 days">Last 14 days</a></li>
                                    <li><a href="#" data-attr="Last 30 days">Last 30 days</a></li>
                                </ul>
                            </div>
                            <div data-id="gender" class="job-filter same-pad gender">
                                <h4 class="option-title">Gender</h4>
                                <ul class="genderlist">

                                </ul>
                            </div>
                            <div data-id="qualification" class="job-filter qualification same-pad">
                                <h4 class="option-title">Qualification</h4>
                                <ul class="qualificationlist">

                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Job Listing End -->

    <!-- Call to Action -->
    <!--    <div class="call-to-action-bg padding-top-90 padding-bottom-90">-->
    <!--        <div class="container">-->
    <!--            <div class="row">-->
    <!--                <div class="col">-->
    <!--                    <div class="call-to-action-2">-->
    <!--                        <div class="call-to-action-content">-->
    <!--                            <h2>For Find Your Dream Job or Candidate</h2>-->
    <!--                            <p>Add resume or post a job. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut elit tellus, luctus nec.</p>-->
    <!--                        </div>-->
    <!--                        <div class="call-to-action-button">-->
    <!--                            <a href="add-resume.html" class="button">Add Resume</a>-->
    <!--                            <span>Or</span>-->
    <!--                            <a href="post-job.html" class="button">Post A Job</a>-->
    <!--                        </div>-->
    <!--                    </div>-->
    <!--                </div>-->
    <!--            </div>-->
    <!--        </div>-->
    <!--    </div>-->
    <!-- Call to Action End -->
    <div class="template display-none">
        <div class="job-list" id="job-list">
            <div class="thumb">
                <a href="#">
                    <img src="{% static 'images/job/company-logo-1.png' %}" class="img-fluid" alt="images">
                </a>
            </div>
            <div class="body">
                <div class="content">
                    <h4><a href="/detail/" class="__job_id dynamic-link"><span class="__title "></span></a></h4>
                    <div class="info">
                        <span class="company"><a href="#" ><i data-feather="briefcase"></i><span class="__company_name"></span></a></span>
                        <span class="office-location"><a href="#"><i data-feather="map-pin"></i><span class="__job_location"></span></a></span>
                        <span class="job-type full-time"><a href="#"><i data-feather="clock"></i><span class="__employment_status"></span></a></span>
                    </div>
                </div>
                <div class="more">
                    <div class="buttons">
                        <a href="/update/" class="button __job_id dynamic-link">Apply</a>
                        <a href="#" class="favourite"><i data-feather="heart"></i></a>
                    </div>
                    <p class="deadline">Deadline: <span class="__application_deadline"></span></p>
                </div>
            </div>
        </div>

    </div>

{% endblock %}
{% block extra_js %}
    <script>
        $(document).ready(function () {
            var pageSize = 2;
            get('/api/job_list/?page=1&page_size='+pageSize,fetchDatacallback);
            var template = $('.template').html();

            socialUrl = '/api/settings/';
            get(socialUrl,loadSocialIcon);

            jobtype_url = '/job_type';
            get(jobtype_url, loadJobtype);

            experi_url = '/experience';
            get(experi_url,loadExperience);

            gender_url = '/gender';
            get(gender_url,loadGender);

            quali_url = '/qualification';
            get(quali_url, loadQualification);


            location_url = '/api/location/';
            get(location_url,loadLoc);


            cat_url='/api/popular_categories/';
            get(cat_url,loadCat);

            favouriteJobAddRemove('job-list', '/api/favourite_job_add/');

            skill_url = '/api/skill_list/';
            get(skill_url,loadskill);



            function fetchDatacallback(data){
                var totalNumberOfData = data.count;
                if (data.previous == null && totalNumberOfData > 0){
                    var numberOfDataInSinglePage = data.results.length;
                    var paginationSummary = "Showing 1-" + numberOfDataInSinglePage + ' of ' + totalNumberOfData + ' Jobs';
                    $('.pagination-summary').show().html(paginationSummary);
                }
                var list = makeListHtml(data.results, template);
                $('.job-result').html(list);
                var url = '/job_list';
                var startingIndex=1;
                makePagination(totalNumberOfData, pageSize, url, startingIndex);
                $(".page-numbers:nth-child(2)").addClass('current');


            }

            $("body").delegate(".page-numbers", "click", function(){
                $('.page-numbers').removeClass('current');
                $(this).addClass('current');
                var paginationIndex = $(this).data('value');
                if (paginationIndex=='prev'){

                }else if(paginationIndex=='next'){

                }
                get('/api/job_list/?page='+ paginationIndex +'&page_size='+pageSize,fetchPaginationDatacallback);


            });


            function loadSocialIcon(data) {
                data = data[0]
                console.log(data)
                $('.facebook-url').attr('href', data.facebook_url);
                $('.linkedin-url').attr('href', data.linkedin_url);
                $('.twitter-url').attr('href', data.twitter_url);
            }




            function loadLoc(data){

                len = data.length;
                for(x=0;x<len;x++){
                    $('#location').append('<option value="'+data[x].name+'">'+data[x].name+'</option>');
                }
                $('.selectpicker').selectpicker('refresh');
            }

            function loadCat(data){

                len = data.length;
                for(x=0;x<len;x++){
                    $('#category').append('<option value="'+data[x].name+'">'+data[x].name+'</option>');
                }
                $('.selectpicker').selectpicker('refresh');

            }

             function loadskill(data){
                console.log(data);
                len = data.length;
                for(x=0;x<len;x++){
                    $('#skill').append('<option value="'+data[x].name+'">'+data[x].name+'</option>');
                }
                $('.selectpicker').selectpicker('refresh');
            }



            function loadJobtype(data) {
                len = data.length;
                {#console.log(data)#}
                for(i=0;i<len;i++){
                    var jobtype_html = '<li class="full-time">'+
                        '<i data-feather="clock">'+
                        '</i>'+
                        '<a href="#">'+data[i].name+'</a>'+
                        '</li>';
                    $('.typelist').append(jobtype_html);
                    feather.replace();
                }}


            function loadExperience(data){
                for(x=1;x<=6;x++){
                    $('.experiencelist').append('<li><a href="#"</a>'+data[x]+'</li>');
                }
            }


            function loadGender(data){
                len = data.length;
                {#console.log(data)#}
                for(x=0;x<len;x++){
                    $('.genderlist').append('<li><a href="#"</a>'+data[x].name+'</li>');
                }
            }


            function loadQualification(data){
                len = data.length;
                {#console.log(data)#}
                for(x=0;x<len;x++){
                    $('.qualificationlist').append('<li><a href="#"</a>'+data[x].name+'</li>');
                }
            }

            function fetchPaginationDatacallback(data){
                var currentIndex=$('.page-numbers.current').data('value');
                var totalNumberOfData = data.count;
                if (data.previous == null && totalNumberOfData > 0){
                    var numberOfDataInSinglePage = data.results.length;
                    var paginationSummary = "Showing 1-" + numberOfDataInSinglePage + ' of ' + totalNumberOfData + ' Jobs';
                    $('.pagination-summary').show().html(paginationSummary);
                }
                var list = makeListHtml(data.results, template);
                $('.job-result').html(list);
                var url = '/job_list';
                makePagination(totalNumberOfData, pageSize, url, currentIndex);

                $('.page-numbers[data-value=' + currentIndex + ']').addClass("current");

            }

        })
    </script>
{% endblock %}